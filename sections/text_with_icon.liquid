{%- comment -%}
  Block: Text with Icon
  Renders text with an optional icon on either side
{%- endcomment -%}

{%- liquid
  assign icon_type = block.settings.icon_type
  assign icon_position = block.settings.icon_position
  assign icon_size = block.settings.icon_size
  assign icon_gap = block.settings.icon_gap
  assign icon_color = block.settings.icon_color
  assign custom_icon = block.settings.custom_icon
  assign text = block.settings.text
  assign type_preset = block.settings.type_preset
  assign font_size = block.settings.font_size
-%}

<div 
  class="marquee__text-with-icon marquee__text-with-icon--icon-{{ icon_position }}"
  style="
    --icon-size: {{ icon_size }}px;
    --icon-gap: {{ icon_gap }}px;
    --icon-color: {{ icon_color }};
    {%- if type_preset == 'custom' -%}
      font-size: {{ font_size }}px;
    {%- endif -%}
  "
  {{ block.shopify_attributes }}
>
  {%- if icon_type != 'none' -%}
    <span class="marquee__icon">
      {%- if icon_type == 'image' and custom_icon -%}
        <img 
          src="{{ custom_icon | image_url: width: icon_size | times: 2 }}"
          alt=""
          width="{{ icon_size }}"
          height="{{ icon_size }}"
          loading="lazy"
        >
      {%- else -%}
        {%- case icon_type -%}
          {%- when 'star' -%}
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" style="color: var(--icon-color);">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </svg>
          {%- when 'heart' -%}
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" style="color: var(--icon-color);">
              <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
            </svg>
          {%- when 'check' -%}
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" style="color: var(--icon-color);">
              <polyline points="20 6 9 17 4 12"/>
            </svg>
          {%- when 'arrow_right' -%}
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: var(--icon-color);">
              <line x1="5" y1="12" x2="19" y2="12"/>
              <polyline points="12 5 19 12 12 19"/>
            </svg>
          {%- when 'arrow_left' -%}
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: var(--icon-color);">
              <line x1="19" y1="12" x2="5" y2="12"/>
              <polyline points="12 19 5 12 12 5"/>
            </svg>
          {%- when 'sparkle' -%}
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" style="color: var(--icon-color);">
              <path d="M12 0L14.59 8.41L23 11L14.59 13.59L12 22L9.41 13.59L1 11L9.41 8.41L12 0Z"/>
            </svg>
          {%- when 'fire' -%}
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" style="color: var(--icon-color);">
              <path d="M12 23c-4.97 0-9-3.58-9-8 0-2.52 1.17-4.83 3-6.36V7c0-.55.45-1 1-1s1 .45 1 1v1.3c1.24-.91 2.77-1.3 4.31-1.3 1.54 0 3.07.39 4.31 1.3V7c0-.55.45-1 1-1s1 .45 1 1v1.64c1.83 1.53 3 3.84 3 6.36 0 4.42-4.03 8-9 8zm0-14c-3.87 0-7 2.69-7 6s3.13 6 7 6 7-2.69 7-6-3.13-6-7-6z"/>
              <path d="M12 2C10.35 2 9 3.35 9 5v1.64c.93-.42 1.94-.64 3-.64s2.07.22 3 .64V5c0-1.65-1.35-3-3-3z"/>
            </svg>
          {%- when 'lightning' -%}
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" style="color: var(--icon-color);">
              <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
            </svg>
          {%- when 'gift' -%}
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: var(--icon-color);">
              <polyline points="20 12 20 22 4 22 4 12"/>
              <rect x="2" y="7" width="20" height="5"/>
              <line x1="12" y1="22" x2="12" y2="7"/>
              <path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"/>
              <path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"/>
            </svg>
          {%- when 'truck' -%}
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: var(--icon-color);">
              <rect x="1" y="3" width="15" height="13"/>
              <polygon points="16 8 20 8 23 11 23 16 16 16 16 8"/>
              <circle cx="5.5" cy="18.5" r="2.5"/>
              <circle cx="18.5" cy="18.5" r="2.5"/>
            </svg>
          {%- when 'percent' -%}
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: var(--icon-color);">
              <line x1="19" y1="5" x2="5" y2="19"/>
              <circle cx="6.5" cy="6.5" r="2.5"/>
              <circle cx="17.5" cy="17.5" r="2.5"/>
            </svg>
          {%- when 'tag' -%}
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: var(--icon-color);">
              <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/>
              <line x1="7" y1="7" x2="7.01" y2="7"/>
            </svg>
        {%- endcase -%}
      {%- endif -%}
    </span>
  {%- endif -%}

  <span class="marquee__text {% if type_preset != 'custom' %}{{ type_preset }}{% endif %}">
    {{- text -}}
  </span>
</div>
