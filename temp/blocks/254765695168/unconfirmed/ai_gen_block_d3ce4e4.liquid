{% doc %}
  @prompt
    ¡Claro, Brigitte! El error es técnico: si el prompt no especifica que debe ser una "sección con capacidad de añadir bloques (blocks)", el sistema te da una sola caja estática. Para que tengas las tres (Filosofía, Misión y Visión) y que cada una sea una "estación" de pantalla completa, necesitamos activar la función de "Blocks" en el esquema de Shopify.
    
    Aquí tienes el prompt corregido y reforzado para que te genere el sistema de múltiples tarjetas:
    
    Prompt Maestro: Sección Dinámica de "Stacked Cards" (Múltiples Bloques)
    Crea una sección para Shopify basada en un esquema de bloques repetibles (blocks), permitiendo añadir un mínimo de tres tarjetas independientes que utilicen el efecto de Sticky Stacking. Cada tarjeta debe estar configurada para ocupar el 100% de la altura de la pantalla (100vh), de modo que al scrollear, cada nueva tarjeta se apile sobre la anterior cubriendo todo el campo visual.
    
    El sistema debe permitir que cada bloque (tarjeta) sea personalizado por separado desde el editor de Shopify con las siguientes opciones:
    
    Contenido: Campos para editar Título y Texto Descriptivo.
    
    Estilo: Selectores individuales para el color de fondo, color de fuente (título y cuerpo), color de borde y tipografía.
    
    Alineación: Un control para elegir la alineación del texto (izquierda, derecha, centrado o justificado) específicamente para cada tarjeta.
    
    Diseño: Un border-radius global de 15px, borde de 1px y controles de padding interno.
    
    La sección debe incluir una animación de entrada (fade-in) para el contenido de cada bloque que se active al entrar en el viewport. Debe ser totalmente responsiva, asegurando que en móviles las tarjetas se apilen correctamente manteniendo los 100vh o ajustándose al contenido. Incluye controles globales para el espaciado superior e inferior (padding top/bottom) de la sección completa.
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-stacked-card-{{ ai_gen_id }} {
    display: block;
    position: sticky;
    top: 0;
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: {{ block.settings.padding_vertical }}px {{ block.settings.padding_horizontal }}px;
    background-color: {{ block.settings.background_color }};
    border: {{ block.settings.border_width }}px solid {{ block.settings.border_color }};
    border-radius: {{ block.settings.border_radius }}px;
    opacity: 0;
    transform: translateY(30px);
    transition: opacity 0.6s ease-out, transform 0.6s ease-out;
  }

  .ai-stacked-card-{{ ai_gen_id }}.ai-visible-{{ ai_gen_id }} {
    opacity: 1;
    transform: translateY(0);
  }

  .ai-stacked-card-content-{{ ai_gen_id }} {
    max-width: 800px;
    width: 100%;
    text-align: {{ block.settings.text_alignment }};
  }

  .ai-stacked-card-title-{{ ai_gen_id }} {
    font-family: {{ block.settings.title_font.family }}, {{ block.settings.title_font.fallback_families }};
    font-weight: {{ block.settings.title_font.weight }};
    font-size: {{ block.settings.title_size }}px;
    color: {{ block.settings.title_color }};
    margin: 0 0 20px 0;
    line-height: 1.2;
  }

  .ai-stacked-card-description-{{ ai_gen_id }} {
    font-family: {{ block.settings.description_font.family }}, {{ block.settings.description_font.fallback_families }};
    font-weight: {{ block.settings.description_font.weight }};
    font-size: {{ block.settings.description_size }}px;
    color: {{ block.settings.description_color }};
    line-height: 1.6;
    margin: 0;
  }

  @media screen and (max-width: 749px) {
    .ai-stacked-card-{{ ai_gen_id }} {
      min-height: auto;
      padding: {{ block.settings.padding_vertical | times: 0.6 }}px {{ block.settings.padding_horizontal | times: 0.6 }}px;
    }

    .ai-stacked-card-title-{{ ai_gen_id }} {
      font-size: {{ block.settings.title_size | times: 0.7 }}px;
    }

    .ai-stacked-card-description-{{ ai_gen_id }} {
      font-size: {{ block.settings.description_size | times: 0.9 }}px;
    }
  }
{% endstyle %}

<stacked-card-{{ ai_gen_id }}
  class="ai-stacked-card-{{ ai_gen_id }}"
  {{ block.shopify_attributes }}
>
  <div class="ai-stacked-card-content-{{ ai_gen_id }}">
    {% if block.settings.title != blank %}
      <h2 class="ai-stacked-card-title-{{ ai_gen_id }}">
        {{ block.settings.title }}
      </h2>
    {% endif %}

    {% if block.settings.description != blank %}
      <div class="ai-stacked-card-description-{{ ai_gen_id }}">
        {{ block.settings.description }}
      </div>
    {% endif %}
  </div>
</stacked-card-{{ ai_gen_id }}>

<script>
  (function() {
    class StackedCard{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
        this.observer = null;
      }

      connectedCallback() {
        this.setupIntersectionObserver();
      }

      setupIntersectionObserver() {
        const options = {
          root: null,
          rootMargin: '0px',
          threshold: 0.2
        };

        this.observer = new IntersectionObserver((entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.add('ai-visible-{{ ai_gen_id }}');
            }
          });
        }, options);

        this.observer.observe(this);
      }

      disconnectedCallback() {
        if (this.observer) {
          this.observer.disconnect();
        }
      }
    }

    customElements.define('stacked-card-{{ ai_gen_id }}', StackedCard{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Tarjeta apilada",
  "settings": [
    {
      "type": "header",
      "content": "Contenido"
    },
    {
      "type": "inline_richtext",
      "id": "title",
      "label": "Título",
      "default": "Nuestra filosofía"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Descripción",
      "default": "<p>Creemos en la innovación constante y en ofrecer productos de la más alta calidad a nuestros clientes.</p>"
    },
    {
      "type": "header",
      "content": "Alineación"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Alineación del texto",
      "options": [
        {
          "value": "left",
          "label": "Izquierda"
        },
        {
          "value": "center",
          "label": "Centro"
        },
        {
          "value": "right",
          "label": "Derecha"
        },
        {
          "value": "justify",
          "label": "Justificado"
        }
      ],
      "default": "center"
    },
    {
      "type": "header",
      "content": "Colores"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Fondo",
      "default": "#efebe5"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Color del título",
      "default": "#3e2563"
    },
    {
      "type": "color",
      "id": "description_color",
      "label": "Color de la descripción",
      "default": "#3e2563"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Color del borde",
      "default": "#3e2563"
    },
    {
      "type": "header",
      "content": "Tipografía del título"
    },
    {
      "type": "font_picker",
      "id": "title_font",
      "label": "Fuente del título",
      "default": "montserrat_n7"
    },
    {
      "type": "range",
      "id": "title_size",
      "label": "Tamaño del título",
      "min": 20,
      "max": 80,
      "step": 2,
      "unit": "px",
      "default": 48
    },
    {
      "type": "header",
      "content": "Tipografía de la descripción"
    },
    {
      "type": "font_picker",
      "id": "description_font",
      "label": "Fuente de la descripción",
      "default": "montserrat_n4"
    },
    {
      "type": "range",
      "id": "description_size",
      "label": "Tamaño de la descripción",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "default": 16
    },
    {
      "type": "header",
      "content": "Diseño"
    },
    {
      "type": "range",
      "id": "border_radius",
      "label": "Radio del borde",
      "min": 0,
      "max": 40,
      "step": 1,
      "unit": "px",
      "default": 15
    },
    {
      "type": "range",
      "id": "border_width",
      "label": "Ancho del borde",
      "min": 0,
      "max": 10,
      "step": 1,
      "unit": "px",
      "default": 1
    },
    {
      "type": "range",
      "id": "padding_vertical",
      "label": "Espaciado vertical",
      "min": 20,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_horizontal",
      "label": "Espaciado horizontal",
      "min": 20,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 40
    },
    {
      "type": "range",
      "id": "desktop_width_percent",
      "label": "Ancho en escritorio",
      "min": 50,
      "max": 100,
      "step": 5,
      "unit": "%",
      "default": 100
    }
  ],
  "presets": [
    {
      "name": "Tarjeta apilada"
    }
  ],
  "tag": null
}
{% endschema %}
